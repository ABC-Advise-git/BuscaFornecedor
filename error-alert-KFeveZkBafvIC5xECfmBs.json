{"updatedAt":"2026-02-05T20:27:43.142Z","createdAt":"2026-02-04T13:53:01.302Z","id":"KFeveZkBafvIC5xECfmBs","name":"Error Alert","active":true,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.errorTrigger","typeVersion":1,"position":[-544,0],"id":"f5d75e2a-f546-4d91-9dfb-d7eb080ad6cd","name":"Error Trigger"},{"parameters":{"chatId":"7975856170","text":"={{ $('Code in JavaScript').item.json.text }}\n\nüîó Execu√ß√£o:{{ $('Error Trigger').item.json.execution.url }}\n\n‚è∞ Timestamp:{{ $json.currentDate.toDateTime().format('HH:mm') }}\n","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[80,0],"id":"f6c29cc4-fbc3-44a5-a1e4-5e98b90f02f4","name":"Send a text message","webhookId":"ebd1b843-f8af-49b0-9e8b-b3695a252257","credentials":{"telegramApi":{"id":"ca8xxX5A84aox0Rt","name":"Telegram Felipe"}}},{"parameters":{"jsCode":"function sanitize(s) {\n  if (s == null) return '';\n\n  return String(s)\n    // Escape para MarkdownV2\n    .replace(/[_*[\\]()~`>#+\\-=|{}.!]/g, '\\\\$&')\n    // Escape b√°sico de HTML\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;');\n}\n\n// Sanitiza os campos\nconst workflow = sanitize($json.workflow?.name);\nconst message = sanitize($json.execution?.error?.message);\nconst lastNode = sanitize($json.execution?.lastNodeExecuted);\nconst now = new Date().toLocaleString('pt-BR');\n\n// Monta o texto final\nconst text = \n`üö® *ERRO NO WORKFLOW ‚Äî BuscaFornecedor*\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nüìå Fluxo:\n${workflow}\n\nüß© N√≥ com falha:\n${lastNode}\n\nüí¨ Mensagem do erro:\n${message}\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;\n\nreturn [\n  {\n    text\n  }\n];\n\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-336,0],"id":"5cb30c6b-7073-40b0-aff4-574eda7385bd","name":"Code in JavaScript"},{"parameters":{"options":{"timezone":"America/Sao_Paulo"}},"type":"n8n-nodes-base.dateTime","typeVersion":2,"position":[-128,0],"id":"02435bc2-abb6-4006-a858-488cbc1dd414","name":"Date & Time"}],"connections":{"Error Trigger":{"main":[[{"node":"Code in JavaScript","type":"main","index":0}]]},"Code in JavaScript":{"main":[[{"node":"Date & Time","type":"main","index":0}]]},"Date & Time":{"main":[[{"node":"Send a text message","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","availableInMCP":false},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"Error Trigger":[{"json":{"execution":{"id":"239779","url":"https://primary-kpc3-buscafornecedor.up.railway.app/workflow/NNrUorIHd2u40SqG/executions/239779","error":{"level":"warning","tags":{},"errorResponse":{"level":"warning","tags":{},"timestamp":1770228767578,"context":{},"functionality":"regular","name":"NodeOperationError","node":{"parameters":{"aiAgentStarterCallout":"","preBuiltAgentsCallout":"","promptType":"define","text":"=Escopo: {{ $json.body.filtro_supabase }}\nEmpresas: {{ $json.body.data.toJsonString() }}","hasOutputParser":true,"notice":"","needsFallback":false,"options":{"systemMessage":"=ROLE (Papel):\nVoc√™ √© um Agente de IA Analista de Suprimentos (AI Sourcing Analyst), especializado em qualifica√ß√£o t√©cnica e sele√ß√£o de fornecedores. Sua fun√ß√£o √© avaliar a compatibilidade de uma lista de empresas com um escopo de contrata√ß√£o espec√≠fico, de forma objetiva, met√≥dica e estritamente baseada nas evid√™ncias textuais fornecidas. Sua maior diretriz √© a avers√£o ao risco, evitando fazer suposi√ß√µes ou infer√™ncias que n√£o possam ser comprovadas pelos dados.\n\nACTION (A√ß√£o):\nVoc√™ ir√° analisar um escopo_contratacao e uma lista_fornecedores fornecida. Para cada fornecedor na lista, voc√™ ir√° gerar um objeto JSON contendo a raz√£o social, uma nota (de 0 a 100) e uma justificativa estruturada para essa nota, consolidando toda a an√°lise em uma √∫nica estrutura JSON final.\n\nCONTEXT (Contexto):\nO escopo_contratacao descreve o servi√ßo ou material necess√°rio, incluindo o segmento de mercado onde a demanda se aplica. A lista_fornecedores √© um array de objetos JSON, onde cada objeto representa uma empresa com dados estruturados (incluindo razao_social, resumo_empresa, especialidades, etc.).\n\nRegra de Ouro: Sua an√°lise deve ser rigorosa e c√©tica. N√ÉO FA√áA SUPOSI√á√ïES. A aus√™ncia de informa√ß√£o expl√≠cita significa que a capacidade n√£o pode ser confirmada.\n\nExemplo 1: Se o escopo √© \"fornecimento de refei√ß√µes corporativas\" e o fornecedor √© um \"restaurante\", voc√™ n√£o pode assumir que ele possui a log√≠stica para entregas corporativas, a menos que os campos especialidades ou exemplo_servico mencionem explicitamente \"refei√ß√µes para empresas\", \"catering corporativo\" ou similar.\n\nExemplo 2: Se o escopo √© \"servi√ßos de funda√ß√£o para obras\" e a empresa se descreve como \"construtora\", voc√™ n√£o pode assumir que ela executa funda√ß√µes, a menos que \"funda√ß√µes\" ou \"geotecnia\" estejam listados em especialidades.\n\nEXECUTE (Execu√ß√£o):\nPara cada fornecedor na lista_fornecedores, execute os seguintes passos para gerar a resposta:\n\nAn√°lise do Escopo: Identifique as palavras-chave principais do escopo_contratacao, incluindo:\n\nServi√ßo/Material Principal: (ex: \"manuten√ß√£o industrial\").\n\nSegmento de Mercado Alvo: (ex: \"ind√∫stria farmac√™utica\").\n\nTipo de Demanda: (Servi√ßo ou Material).\n\nC√°lculo da nota (0-100): A nota ser√° a soma ponderada dos seguintes crit√©rios:\n\nCrit√©rio 1: Especificidade Direta (Peso 65%)\n\nAnalise especialidades e exemplo_servico.\n\n65 pontos: Men√ß√£o expl√≠cita do servi√ßo/material principal.\n\n30 pontos: Men√ß√£o de termos correlatos.\n\n0 pontos: Nenhuma men√ß√£o.\n\nCrit√©rio 2: Alinhamento com Segmento de Mercado (Peso 15%)\n\nAnalise segmentos_industriais e especialidades.\n\n15 pontos: Men√ß√£o expl√≠cita do segmento alvo.\n\n10 pontos: Men√ß√£o de segmento correlato.\n\n0 pontos: Nenhuma men√ß√£o.\n\nCrit√©rio 3: Compatibilidade do Tipo de Fornecedor (Peso 10%)\n\nAnalise tipo_fornecedor.\n\n10 pontos: Compatibilidade total.\n\n0 pontos: Incompatibilidade.\n\nCrit√©rio 4: Evid√™ncia de Suporte no Resumo (Peso 10%)\n\nAnalise resumo_empresa.\n\n10 pontos: Refor√ßa a capacidade.\n\n5 pontos: Gen√©rico, mas n√£o contradiz.\n\n0 pontos: Foco em atividades distintas.\n\nElabora√ß√£o da justificativa:\n\nCrie um objeto JSON para a justificativa.\n\nEste objeto deve conter um resumo_parecer e uma an√°lise detalhada para cada crit√©rio, informando a pontua√ß√£o e a evid√™ncia textual (ou a falta dela) que baseou a decis√£o.\n\nFormata√ß√£o da Resposta:\n\nA resposta final deve ser um √∫nico objeto JSON com a chave empresas. O valor dessa chave ser√° um array de objetos, onde cada objeto representa um fornecedor e segue estritamente o formato aprimorado abaixo:\n\nJSON\n\n{\n  \"empresas\": [\n    {\n      \"razao_social\": \"Solu√ß√µes Industriais Integradas Ltda.\",\n      \"cnpj_basico\": \"12345678\",\n      \"instagram\": \"https://www.instagram.com/solucoesindustriais\",\n      \"email\": \"contato@solucoesindustriais.com.br\",\n      \"telefone\": \"+55 31 3333-4444\",\n      \"site\": \"https://www.solucoesindustriais.com.br\",\n      \"nota\": 90,\n      \"justificativa\": {\n        \"resumo_parecer\": \"Ader√™ncia muito alta. O fornecedor demonstra especializa√ß√£o direta no servi√ßo e no segmento de mercado solicitados.\",\n        \"analise_especificidade\": \"Pontua√ß√£o: 50/50. Evid√™ncia: O campo 'exemplo_servico' cita explicitamente 'Manuten√ß√£o Industrial' e 'Manuten√ß√£o Preditiva'.\",\n        \"analise_segmento\": \"Pontua√ß√£o: 30/30. Evid√™ncia: O campo 'especialidades' destaca o atendimento a 'Minera√ß√£o e Siderurgia', que corresponde ao escopo.\",\n        \"analise_tipo_fornecedor\": \"Pontua√ß√£o: 10/10. Evid√™ncia: O 'tipo_fornecedor' como 'servico' est√° correto.\",\n        \"analise_resumo_suporte\": \"Pontua√ß√£o: 10/10. Evid√™ncia: O 'resumo_empresa' refor√ßa o foco em 'manuten√ß√£o para ind√∫strias de base'.\"\n      }\n    },\n    {\n      \"razao_social\": \"Constru√ß√µes e Reformas Prediais S.A.\",\n      \"cnpj_basico\": \"87654321\",\n      \"instagram\": \"https://www.instagram.com/construcoesereformas\",\n      \"email\": \"contato@construcoesereformas.com.br\",\n      \"telefone\": \"+55 11 2222-5555\",\n      \"site\": \"https://www.construcoesereformas.com.br\",\n      \"nota\": 15,\n      \"justificativa\": {\n        \"resumo_parecer\": \"Ader√™ncia muito baixa. O foco da empresa √© em um escopo diferente e n√£o h√° evid√™ncias de atua√ß√£o no segmento de mercado desejado.\",\n        \"analise_especificidade\": \"Pontua√ß√£o: 0/50. Evid√™ncia: Nenhuma men√ß√£o a 'manuten√ß√£o industrial'. Os servi√ßos listados s√£o 'reformas de fachada' e 'gest√£o de condom√≠nios'.\",\n        \"analise_segmento\": \"Pontua√ß√£o: 0/30. Evid√™ncia: O segmento de mercado n√£o √© mencionado.\",\n        \"analise_tipo_fornecedor\": \"Pontua√ß√£o: 10/10. Evid√™ncia: O 'tipo_fornecedor' como 'servico' est√° correto.\",\n        \"analise_resumo_suporte\": \"Pontua√ß√£o: 5/10. Evid√™ncia: O resumo √© gen√©rico, citando 'solu√ß√µes de engenharia', o que n√£o contradiz, mas tamb√©m n√£o adiciona pontos.\"\n      }\n    }\n  ]\n}\n\n\n\nIMPORTANTE: Sua resposta deve conter APENAS o c√≥digo JSON v√°lido, sem nenhum texto introdut√≥rio, coment√°rios ou explica√ß√µes adicionais. O in√≠cio da sua resposta deve ser { e o final deve ser }."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.2,"position":[-912,-16],"id":"d5e7e183-ddfd-4b5e-85ad-40eb2bda0dae","name":"avalia_empresa","retryOnFail":true},"messages":[],"message":"Cannot read properties of undefined (reading 'parts')","stack":"NodeOperationError: Cannot read properties of undefined (reading 'parts')\n    at /usr/local/lib/node_modules/n8n/node_modules/.pnpm/@n8n+n8n-nodes-langchain@file+packages+@n8n+nodes-langchain_483a58943c290d26157214acd0d782a6/node_modules/@n8n/n8n-nodes-langchain/nodes/agents/Agent/agents/ToolsAgent/V2/execute.ts:341:12\n    at Array.forEach (<anonymous>)\n    at ExecuteContext.toolsAgentExecute (/usr/local/lib/node_modules/n8n/node_modules/.pnpm/@n8n+n8n-nodes-langchain@file+packages+@n8n+nodes-langchain_483a58943c290d26157214acd0d782a6/node_modules/@n8n/n8n-nodes-langchain/nodes/agents/Agent/agents/ToolsAgent/V2/execute.ts:330:16)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at ExecuteContext.execute (/usr/local/lib/node_modules/n8n/node_modules/.pnpm/@n8n+n8n-nodes-langchain@file+packages+@n8n+nodes-langchain_483a58943c290d26157214acd0d782a6/node_modules/@n8n/n8n-nodes-langchain/nodes/agents/Agent/V2/AgentV2.node.ts:144:10)\n    at WorkflowExecute.executeNode (/usr/local/lib/node_modules/n8n/node_modules/.pnpm/n8n-core@file+packages+core_@opentelemetry+api@1.9.0_@opentelemetry+sdk-trace-base@1.30_ec37920eb95917b28efaa783206b20f3/node_modules/n8n-core/src/execution-engine/workflow-execute.ts:1045:8)\n    at WorkflowExecute.runNode (/usr/local/lib/node_modules/n8n/node_modules/.pnpm/n8n-core@file+packages+core_@opentelemetry+api@1.9.0_@opentelemetry+sdk-trace-base@1.30_ec37920eb95917b28efaa783206b20f3/node_modules/n8n-core/src/execution-engine/workflow-execute.ts:1226:11)\n    at /usr/local/lib/node_modules/n8n/node_modules/.pnpm/n8n-core@file+packages+core_@opentelemetry+api@1.9.0_@opentelemetry+sdk-trace-base@1.30_ec37920eb95917b28efaa783206b20f3/node_modules/n8n-core/src/execution-engine/workflow-execute.ts:1662:27\n    at /usr/local/lib/node_modules/n8n/node_modules/.pnpm/n8n-core@file+packages+core_@opentelemetry+api@1.9.0_@opentelemetry+sdk-trace-base@1.30_ec37920eb95917b28efaa783206b20f3/node_modules/n8n-core/src/execution-engine/workflow-execute.ts:2297:11","executionId":"239791","workflowId":"9eECybbs7EvlGEra"},"timestamp":1770228767591,"context":{},"functionality":"regular","name":"NodeOperationError","node":{"parameters":{"aiAgentStarterCallout":"","preBuiltAgentsCallout":"","promptType":"define","text":"=Escopo: {{ $json.body.filtro_supabase }}\nEmpresas: {{ $json.body.data.toJsonString() }}","hasOutputParser":true,"notice":"","needsFallback":false,"options":{"systemMessage":"=ROLE (Papel):\nVoc√™ √© um Agente de IA Analista de Suprimentos (AI Sourcing Analyst), especializado em qualifica√ß√£o t√©cnica e sele√ß√£o de fornecedores. Sua fun√ß√£o √© avaliar a compatibilidade de uma lista de empresas com um escopo de contrata√ß√£o espec√≠fico, de forma objetiva, met√≥dica e estritamente baseada nas evid√™ncias textuais fornecidas. Sua maior diretriz √© a avers√£o ao risco, evitando fazer suposi√ß√µes ou infer√™ncias que n√£o possam ser comprovadas pelos dados.\n\nACTION (A√ß√£o):\nVoc√™ ir√° analisar um escopo_contratacao e uma lista_fornecedores fornecida. Para cada fornecedor na lista, voc√™ ir√° gerar um objeto JSON contendo a raz√£o social, uma nota (de 0 a 100) e uma justificativa estruturada para essa nota, consolidando toda a an√°lise em uma √∫nica estrutura JSON final.\n\nCONTEXT (Contexto):\nO escopo_contratacao descreve o servi√ßo ou material necess√°rio, incluindo o segmento de mercado onde a demanda se aplica. A lista_fornecedores √© um array de objetos JSON, onde cada objeto representa uma empresa com dados estruturados (incluindo razao_social, resumo_empresa, especialidades, etc.).\n\nRegra de Ouro: Sua an√°lise deve ser rigorosa e c√©tica. N√ÉO FA√áA SUPOSI√á√ïES. A aus√™ncia de informa√ß√£o expl√≠cita significa que a capacidade n√£o pode ser confirmada.\n\nExemplo 1: Se o escopo √© \"fornecimento de refei√ß√µes corporativas\" e o fornecedor √© um \"restaurante\", voc√™ n√£o pode assumir que ele possui a log√≠stica para entregas corporativas, a menos que os campos especialidades ou exemplo_servico mencionem explicitamente \"refei√ß√µes para empresas\", \"catering corporativo\" ou similar.\n\nExemplo 2: Se o escopo √© \"servi√ßos de funda√ß√£o para obras\" e a empresa se descreve como \"construtora\", voc√™ n√£o pode assumir que ela executa funda√ß√µes, a menos que \"funda√ß√µes\" ou \"geotecnia\" estejam listados em especialidades.\n\nEXECUTE (Execu√ß√£o):\nPara cada fornecedor na lista_fornecedores, execute os seguintes passos para gerar a resposta:\n\nAn√°lise do Escopo: Identifique as palavras-chave principais do escopo_contratacao, incluindo:\n\nServi√ßo/Material Principal: (ex: \"manuten√ß√£o industrial\").\n\nSegmento de Mercado Alvo: (ex: \"ind√∫stria farmac√™utica\").\n\nTipo de Demanda: (Servi√ßo ou Material).\n\nC√°lculo da nota (0-100): A nota ser√° a soma ponderada dos seguintes crit√©rios:\n\nCrit√©rio 1: Especificidade Direta (Peso 65%)\n\nAnalise especialidades e exemplo_servico.\n\n65 pontos: Men√ß√£o expl√≠cita do servi√ßo/material principal.\n\n30 pontos: Men√ß√£o de termos correlatos.\n\n0 pontos: Nenhuma men√ß√£o.\n\nCrit√©rio 2: Alinhamento com Segmento de Mercado (Peso 15%)\n\nAnalise segmentos_industriais e especialidades.\n\n15 pontos: Men√ß√£o expl√≠cita do segmento alvo.\n\n10 pontos: Men√ß√£o de segmento correlato.\n\n0 pontos: Nenhuma men√ß√£o.\n\nCrit√©rio 3: Compatibilidade do Tipo de Fornecedor (Peso 10%)\n\nAnalise tipo_fornecedor.\n\n10 pontos: Compatibilidade total.\n\n0 pontos: Incompatibilidade.\n\nCrit√©rio 4: Evid√™ncia de Suporte no Resumo (Peso 10%)\n\nAnalise resumo_empresa.\n\n10 pontos: Refor√ßa a capacidade.\n\n5 pontos: Gen√©rico, mas n√£o contradiz.\n\n0 pontos: Foco em atividades distintas.\n\nElabora√ß√£o da justificativa:\n\nCrie um objeto JSON para a justificativa.\n\nEste objeto deve conter um resumo_parecer e uma an√°lise detalhada para cada crit√©rio, informando a pontua√ß√£o e a evid√™ncia textual (ou a falta dela) que baseou a decis√£o.\n\nFormata√ß√£o da Resposta:\n\nA resposta final deve ser um √∫nico objeto JSON com a chave empresas. O valor dessa chave ser√° um array de objetos, onde cada objeto representa um fornecedor e segue estritamente o formato aprimorado abaixo:\n\nJSON\n\n{\n  \"empresas\": [\n    {\n      \"razao_social\": \"Solu√ß√µes Industriais Integradas Ltda.\",\n      \"cnpj_basico\": \"12345678\",\n      \"instagram\": \"https://www.instagram.com/solucoesindustriais\",\n      \"email\": \"contato@solucoesindustriais.com.br\",\n      \"telefone\": \"+55 31 3333-4444\",\n      \"site\": \"https://www.solucoesindustriais.com.br\",\n      \"nota\": 90,\n      \"justificativa\": {\n        \"resumo_parecer\": \"Ader√™ncia muito alta. O fornecedor demonstra especializa√ß√£o direta no servi√ßo e no segmento de mercado solicitados.\",\n        \"analise_especificidade\": \"Pontua√ß√£o: 50/50. Evid√™ncia: O campo 'exemplo_servico' cita explicitamente 'Manuten√ß√£o Industrial' e 'Manuten√ß√£o Preditiva'.\",\n        \"analise_segmento\": \"Pontua√ß√£o: 30/30. Evid√™ncia: O campo 'especialidades' destaca o atendimento a 'Minera√ß√£o e Siderurgia', que corresponde ao escopo.\",\n        \"analise_tipo_fornecedor\": \"Pontua√ß√£o: 10/10. Evid√™ncia: O 'tipo_fornecedor' como 'servico' est√° correto.\",\n        \"analise_resumo_suporte\": \"Pontua√ß√£o: 10/10. Evid√™ncia: O 'resumo_empresa' refor√ßa o foco em 'manuten√ß√£o para ind√∫strias de base'.\"\n      }\n    },\n    {\n      \"razao_social\": \"Constru√ß√µes e Reformas Prediais S.A.\",\n      \"cnpj_basico\": \"87654321\",\n      \"instagram\": \"https://www.instagram.com/construcoesereformas\",\n      \"email\": \"contato@construcoesereformas.com.br\",\n      \"telefone\": \"+55 11 2222-5555\",\n      \"site\": \"https://www.construcoesereformas.com.br\",\n      \"nota\": 15,\n      \"justificativa\": {\n        \"resumo_parecer\": \"Ader√™ncia muito baixa. O foco da empresa √© em um escopo diferente e n√£o h√° evid√™ncias de atua√ß√£o no segmento de mercado desejado.\",\n        \"analise_especificidade\": \"Pontua√ß√£o: 0/50. Evid√™ncia: Nenhuma men√ß√£o a 'manuten√ß√£o industrial'. Os servi√ßos listados s√£o 'reformas de fachada' e 'gest√£o de condom√≠nios'.\",\n        \"analise_segmento\": \"Pontua√ß√£o: 0/30. Evid√™ncia: O segmento de mercado n√£o √© mencionado.\",\n        \"analise_tipo_fornecedor\": \"Pontua√ß√£o: 10/10. Evid√™ncia: O 'tipo_fornecedor' como 'servico' est√° correto.\",\n        \"analise_resumo_suporte\": \"Pontua√ß√£o: 5/10. Evid√™ncia: O resumo √© gen√©rico, citando 'solu√ß√µes de engenharia', o que n√£o contradiz, mas tamb√©m n√£o adiciona pontos.\"\n      }\n    }\n  ]\n}\n\n\n\nIMPORTANTE: Sua resposta deve conter APENAS o c√≥digo JSON v√°lido, sem nenhum texto introdut√≥rio, coment√°rios ou explica√ß√µes adicionais. O in√≠cio da sua resposta deve ser { e o final deve ser }."}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.2,"position":[-912,-16],"id":"d5e7e183-ddfd-4b5e-85ad-40eb2bda0dae","name":"avalia_empresa","retryOnFail":true},"messages":[],"executionId":"239791","workflowId":"9eECybbs7EvlGEra","message":"Cannot read properties of undefined (reading 'parts')","stack":"NodeOperationError: Cannot read properties of undefined (reading 'parts')\n    at /usr/local/lib/node_modules/n8n/node_modules/.pnpm/@n8n+n8n-nodes-langchain@file+packages+@n8n+nodes-langchain_483a58943c290d26157214acd0d782a6/node_modules/@n8n/n8n-nodes-langchain/nodes/agents/Agent/agents/ToolsAgent/V2/execute.ts:341:12\n    at Array.forEach (<anonymous>)\n    at ExecuteContext.toolsAgentExecute (/usr/local/lib/node_modules/n8n/node_modules/.pnpm/@n8n+n8n-nodes-langchain@file+packages+@n8n+nodes-langchain_483a58943c290d26157214acd0d782a6/node_modules/@n8n/n8n-nodes-langchain/nodes/agents/Agent/agents/ToolsAgent/V2/execute.ts:330:16)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at ExecuteContext.execute (/usr/local/lib/node_modules/n8n/node_modules/.pnpm/@n8n+n8n-nodes-langchain@file+packages+@n8n+nodes-langchain_483a58943c290d26157214acd0d782a6/node_modules/@n8n/n8n-nodes-langchain/nodes/agents/Agent/V2/AgentV2.node.ts:144:10)\n    at WorkflowExecute.executeNode (/usr/local/lib/node_modules/n8n/node_modules/.pnpm/n8n-core@file+packages+core_@opentelemetry+api@1.9.0_@opentelemetry+sdk-trace-base@1.30_ec37920eb95917b28efaa783206b20f3/node_modules/n8n-core/src/execution-engine/workflow-execute.ts:1045:8)\n    at WorkflowExecute.runNode (/usr/local/lib/node_modules/n8n/node_modules/.pnpm/n8n-core@file+packages+core_@opentelemetry+api@1.9.0_@opentelemetry+sdk-trace-base@1.30_ec37920eb95917b28efaa783206b20f3/node_modules/n8n-core/src/execution-engine/workflow-execute.ts:1226:11)\n    at /usr/local/lib/node_modules/n8n/node_modules/.pnpm/n8n-core@file+packages+core_@opentelemetry+api@1.9.0_@opentelemetry+sdk-trace-base@1.30_ec37920eb95917b28efaa783206b20f3/node_modules/n8n-core/src/execution-engine/workflow-execute.ts:1662:27\n    at /usr/local/lib/node_modules/n8n/node_modules/.pnpm/n8n-core@file+packages+core_@opentelemetry+api@1.9.0_@opentelemetry+sdk-trace-base@1.30_ec37920eb95917b28efaa783206b20f3/node_modules/n8n-core/src/execution-engine/workflow-execute.ts:2297:11"},"lastNodeExecuted":"Call 'Processa_Empresa copy'","mode":"webhook","executionContext":{"version":1,"establishedAt":1770228700490,"source":"webhook","triggerNode":{"name":"Webhook","type":"n8n-nodes-base.webhook"}}},"workflow":{"id":"NNrUorIHd2u40SqG","name":"Enriquece-CNPJ copy"}},"pairedItem":{"item":0}}]},"versionId":"e59bbb35-0254-45ab-b58f-64f91b1d1b99","activeVersionId":"e59bbb35-0254-45ab-b58f-64f91b1d1b99","triggerCount":0,"shared":[{"updatedAt":"2026-02-04T13:53:01.302Z","createdAt":"2026-02-04T13:53:01.302Z","role":"workflow:owner","workflowId":"KFeveZkBafvIC5xECfmBs","projectId":"jk0yZKautC5L7CBp"}],"activeVersion":{"updatedAt":"2026-02-05T20:27:45.352Z","createdAt":"2026-02-05T20:27:43.135Z","versionId":"e59bbb35-0254-45ab-b58f-64f91b1d1b99","workflowId":"KFeveZkBafvIC5xECfmBs","nodes":[{"parameters":{},"type":"n8n-nodes-base.errorTrigger","typeVersion":1,"position":[-544,0],"id":"f5d75e2a-f546-4d91-9dfb-d7eb080ad6cd","name":"Error Trigger"},{"parameters":{"chatId":"7975856170","text":"={{ $('Code in JavaScript').item.json.text }}\n\nüîó Execu√ß√£o:{{ $('Error Trigger').item.json.execution.url }}\n\n‚è∞ Timestamp:{{ $json.currentDate.toDateTime().format('HH:mm') }}\n","additionalFields":{"appendAttribution":false,"parse_mode":"HTML"}},"type":"n8n-nodes-base.telegram","typeVersion":1.2,"position":[80,0],"id":"f6c29cc4-fbc3-44a5-a1e4-5e98b90f02f4","name":"Send a text message","webhookId":"ebd1b843-f8af-49b0-9e8b-b3695a252257","credentials":{"telegramApi":{"id":"ca8xxX5A84aox0Rt","name":"Telegram Felipe"}}},{"parameters":{"jsCode":"function sanitize(s) {\n  if (s == null) return '';\n\n  return String(s)\n    // Escape para MarkdownV2\n    .replace(/[_*[\\]()~`>#+\\-=|{}.!]/g, '\\\\$&')\n    // Escape b√°sico de HTML\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;');\n}\n\n// Sanitiza os campos\nconst workflow = sanitize($json.workflow?.name);\nconst message = sanitize($json.execution?.error?.message);\nconst lastNode = sanitize($json.execution?.lastNodeExecuted);\nconst now = new Date().toLocaleString('pt-BR');\n\n// Monta o texto final\nconst text = \n`üö® *ERRO NO WORKFLOW ‚Äî BuscaFornecedor*\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nüìå Fluxo:\n${workflow}\n\nüß© N√≥ com falha:\n${lastNode}\n\nüí¨ Mensagem do erro:\n${message}\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n`;\n\nreturn [\n  {\n    text\n  }\n];\n\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-336,0],"id":"5cb30c6b-7073-40b0-aff4-574eda7385bd","name":"Code in JavaScript"},{"parameters":{"options":{"timezone":"America/Sao_Paulo"}},"type":"n8n-nodes-base.dateTime","typeVersion":2,"position":[-128,0],"id":"02435bc2-abb6-4006-a858-488cbc1dd414","name":"Date & Time"}],"connections":{"Error Trigger":{"main":[[{"node":"Code in JavaScript","type":"main","index":0}]]},"Code in JavaScript":{"main":[[{"node":"Date & Time","type":"main","index":0}]]},"Date & Time":{"main":[[{"node":"Send a text message","type":"main","index":0}]]}},"authors":"ABC  advise","name":"Version e59bbb35","description":"","autosaved":false},"tags":[]}