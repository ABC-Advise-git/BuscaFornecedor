{"updatedAt":"2026-01-14T18:02:36.951Z","createdAt":"2025-12-26T21:50:24.658Z","id":"066SnWM5lAL0DjBV","name":"Teste-modelo-runpod","active":false,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-1376,-256],"id":"edfd4d53-5917-4acf-81c8-2c2ed0df8f68","name":"When clicking ‘Execute workflow’"},{"parameters":{"operation":"select","schema":{"__rl":true,"value":"cnpj_db","mode":"list","cachedResultName":"cnpj_db"},"table":{"__rl":true,"value":"empresas_processadas","mode":"list","cachedResultName":"empresas_processadas"},"limit":1,"options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-2192,-688],"id":"c3e1963b-99e2-4ce9-8590-c66966cf6f79","name":"Select rows from a table","credentials":{"postgres":{"id":"8MXZ6U3UVpvutTEe","name":"Supabase"}}},{"parameters":{"assignments":{"assignments":[{"id":"ab52fe2e-e971-4daf-8072-12c52c44fb1e","name":"empresa.nome_fantasia","value":"={{ $json.nome_fantasia }}","type":"string"},{"id":"99075fbe-10f7-4165-a29f-c420e59363a8","name":"empresa.categorias_produtos","value":"={{ $json.categorias_produtos  }}","type":"string"},{"id":"1ff850ec-8cd5-4cd3-8120-b55c72c40e42","name":"empresa.categorias_produtos","value":"={{ $json.categorias_produtos  }}","type":"string"},{"id":"38fcb8a2-0c4e-46cc-b759-fe128ee60271","name":"empresa.industria","value":"={{ $json.industria  }}","type":"string"},{"id":"d5a57830-dc4a-4f30-898b-68e37b587297","name":"empresa.modelo_de_negocio","value":"={{ $json.modelo_de_negocio  }}","type":"string"},{"id":"d90b03ab-1ed1-4d31-b896-f1f977329ded","name":"empresa.resumo_empresa","value":"={{ $json.resumo_empresa  }}","type":"string"},{"id":"5cfb73c2-162d-495b-b4ab-99064fdc63cf","name":"empresa.cobertura_geografica","value":"={{ $json.cobertura_geografica }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1520,-1040],"id":"73e967e0-5918-4a21-a4aa-bebbad2fa31e","name":"Edit Fields"},{"parameters":{"assignments":{"assignments":[{"id":"77a5062d-9702-4677-8b0c-9518185af184","name":"empresa","value":"={{ $json.empresa.toJsonString() }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1312,-1040],"id":"c20ce795-980b-4028-a4cc-c575eca448f3","name":"Edit Fields1"},{"parameters":{"jsCode":"const output = [];\n\nfor (const item of items) {\n  const rawEmpresa = item.json.empresa;\n\n  let empresaObj;\n\n  // 1. Parse do JSON principal\n  try {\n    empresaObj = JSON.parse(rawEmpresa);\n  } catch (e) {\n    throw new Error(`Erro ao fazer JSON.parse em empresa: ${e.message}`);\n  }\n\n  // 2. Normalizar categorias_produtos se vier como string\n  if (\n    empresaObj.categorias_produtos &&\n    typeof empresaObj.categorias_produtos === \"string\"\n  ) {\n    try {\n      empresaObj.categorias_produtos = JSON.parse(\n        empresaObj.categorias_produtos\n      );\n    } catch {\n      // se falhar, mantém como string\n    }\n  }\n\n  // 3. Re-serializar de forma limpa\n  const empresaPrompt = JSON.stringify(empresaObj);\n\n  // 4. Retornar item pronto para LLM\n  output.push({\n    json: {\n      ...item.json,\n      empresa_prompt: empresaPrompt\n    }\n  });\n}\n\nreturn output;\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-1104,-1040],"id":"2bf943eb-babd-4f5f-82f0-81871c7525fc","name":"Code in JavaScript"},{"parameters":{"assignments":{"assignments":[{"id":"4ef77cf2-4abe-4ce2-96d7-8507dd01d5f1","name":"prompt","value":"={{ \n  { \n    model: \"mistralai/Ministral-3-3B-Instruct-2512\", \n    messages: [ \n      { \n        role: \"user\", \n        content: \"Escopo de referência: Empresas SaaS B2B focadas em soluções de tecnologia para Recursos Humanos (HR Tech).\\n\\nTarefa:\\nAnalise a empresa descrita no JSON abaixo e avalie o quanto ela se enquadra no escopo definido. Considere modelo de negócio, indústria, produtos/serviços e público-alvo.\\n\\nResposta obrigatória:\\nAtribua uma nota inteira de 1 a 10, onde 1 significa nenhuma aderência ao escopo e 10 significa aderência total.\\nInclua uma justificativa breve, objetiva e com no máximo 100 tokens.\\n\\nFormato da resposta (obrigatório):\\nNOTA: X/10\\nJUSTIFICATIVA: <texto curto>\"\n      }, \n      { \n        role: \"user\", \n        content: $json.empresa_prompt \n      } \n    ], \n    temperature: 0.15, \n    max_tokens: 120, \n    stream: false   \n  } \n}}","type":"object"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-896,-1040],"id":"55e5e70b-6a7f-4a27-89ef-a8f061797f00","name":"Edit Fields2"},{"parameters":{"assignments":{"assignments":[{"id":"417a690b-8f91-48fe-a25e-5efc9ef82df0","name":"usage.total_tokens","value":"={{ $json.usage.total_tokens }}","type":"number"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-1312,-832],"id":"119900e8-233c-4258-9553-6ca8bd5a2245","name":"Edit Fields3"},{"parameters":{"fieldsToSummarize":{"values":[{"aggregation":"sum","field":"usage.total_tokens"}]},"options":{}},"type":"n8n-nodes-base.summarize","typeVersion":1.1,"position":[-1104,-832],"id":"f4b174f7-27db-4136-af10-1e761f8bc380","name":"Summarize"},{"parameters":{"method":"POST","url":"https://5u888x525vvzvs-8000.proxy.runpod.net/v1/chat/completions","sendHeaders":true,"specifyHeaders":"=keypair","headerParameters":{"parameters":[{}]},"sendBody":true,"specifyBody":"json","jsonBody":"={{ $json.prompt }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[-1872,-1040],"id":"f729b621-33c3-4eda-a86e-596d6ba1a79e","name":"LLM"},{"parameters":{"method":"POST","url":"https://vm-phoenix-tracer-buscafornecedor.up.railway.app/v1/chat/completions","sendBody":true,"specifyBody":"json","jsonBody":"={\n  \"model\": \"mistralai/Ministral-3-3B-Instruct-2512\",\n  \"messages\": [\n    {\n      \"role\": \"user\",\n      \"content\": \"Explique o que é n8n em uma frase.\"\n    }\n  ],\n  \"temperature\": 0.7\n}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[-1872,-864],"id":"76f5a274-6fdb-452a-9db6-85d95f342121","name":"Phoenix"},{"parameters":{"url":"https://5u888x525vvzvs-9100.proxy.runpod.net/metrics","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.3,"position":[-1872,-704],"id":"7def4681-e7d7-437f-86dd-d14f491f2453","name":"Metrics"},{"parameters":{"workflowId":{"__rl":true,"value":"WmhV0GzExyOfmgPK6I7_d","mode":"list","cachedResultUrl":"/workflow/WmhV0GzExyOfmgPK6I7_d","cachedResultName":"Processa Scrape Fornecedores"},"workflowInputs":{"mappingMode":"defineBelow","value":{},"matchingColumns":[],"schema":[],"attemptToConvertTypes":false,"convertFieldsToString":true},"mode":"each","options":{"waitForSubWorkflow":false}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.3,"position":[-176,-112],"id":"4931a72c-05bd-4e9f-9bcf-45464ed59f69","name":"Call 'Processa Scrape Fornecedores'"},{"parameters":{"batchSize":5,"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[-656,-256],"id":"35d0fcb9-726d-4975-b60b-56cd7d0fa855","name":"Loop Over Items"},{"parameters":{"amount":2},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[64,-64],"id":"8370d811-64be-4e97-9a79-6f1e56a3929c","name":"Wait","webhookId":"40662786-d392-4742-be4b-3067a485d397"},{"parameters":{"jsCode":"const items = [];\n\nfor (let i = 1; i <= 50; i++) {\n  items.push({ json: { index: i } });\n}\n\nreturn items;\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-1136,-256],"id":"4f8a7cc4-a9af-432d-bc0f-1fa1e2f5d79a","name":"Code in JavaScript1"},{"parameters":{"assignments":{"assignments":[{"id":"a8baeeed-f4a3-4213-a5ec-0f4ab2137d69","name":"text","value":"BLOCO 1 — CONTEXTO INSTITUCIONAL E IDENTIDADE  A empresa conhecida comercialmente como CAIS DO PAPEL opera há anos em um segmento tradicional do mercado brasileiro, com forte presença no varejo físico e atuação consolidada no fornecimento de produtos voltados ao consumo corporativo e doméstico. Seu posicionamento não nasce como uma empresa de tecnologia, mas como uma organização orientada à distribuição e comercialização de itens essenciais para escritórios, instituições de ensino, profissionais autônomos e consumidores finais. Ao longo do tempo, a empresa estruturou sua identidade em torno da confiabilidade logística, variedade de portfólio e atendimento regional especializado, mantendo uma operação alinhada às demandas locais do município de São João da Boa Vista, no interior do estado de São Paulo.  A identidade da empresa se constrói a partir da diversidade de produtos comercializados, abrangendo desde materiais escolares básicos até suprimentos mais específicos utilizados em ambientes corporativos e residenciais. Embora o nome “CAIS DO PAPEL” remeta diretamente ao segmento de papelaria, sua atuação extrapola esse escopo restrito, incorporando itens de informática, acessórios, utilidades domésticas e produtos complementares que ampliam o ticket médio e o alcance de mercado. A empresa não se posiciona como desenvolvedora de soluções digitais, tampouco como provedora de software, mas sim como uma operação de varejo estruturada em catálogo amplo e presença física.  BLOCO 2 — PORTFÓLIO DE PRODUTOS E CATEGORIAS  O portfólio da empresa é organizado em múltiplas categorias de produtos, refletindo uma estratégia de abrangência e capilaridade comercial. Entre as categorias mais relevantes encontram-se materiais escolares, amplamente utilizados por estudantes, professores e instituições de ensino, além de materiais de escritório voltados ao uso corporativo cotidiano. Esses itens incluem papéis, pastas, organizadores, instrumentos de escrita e acessórios administrativos que sustentam o funcionamento básico de empresas de diferentes portes.  Além disso, a empresa comercializa materiais voltados à engenharia e áreas técnicas, bem como produtos associados ao artesanato e atividades manuais, ampliando sua base de clientes para além do público corporativo tradicional. O catálogo também contempla suprimentos de informática, acessórios para games, bolsas para notebooks, telefones, calculadoras e carregadores, indicando uma estratégia de cross-selling voltada à conveniência do consumidor. Esse conjunto de categorias evidencia uma operação focada em varejo diversificado, com baixa especialização vertical, mas alto volume de SKUs, característica típica de papelarias de médio porte com atuação regional.  BLOCO 3 — MODELO DE NEGÓCIO E OPERAÇÃO  Do ponto de vista de modelo de negócio, a CAIS DO PAPEL opera predominantemente no varejo, com foco na venda direta de produtos físicos. Sua estrutura não envolve assinatura recorrente, licenciamento de tecnologia ou prestação de serviços digitais escaláveis, mas sim a comercialização unitária de itens tangíveis. A receita é gerada a partir do giro de estoque e da margem sobre produtos, exigindo gestão logística eficiente, controle de inventário e relacionamento próximo com fornecedores.  A maturidade da operação está associada à capacidade de manter variedade de produtos, atender demandas locais com rapidez e sustentar relacionamento com clientes recorrentes, especialmente empresas e instituições que demandam reposição constante de materiais. Não há indícios de automação avançada baseada em software proprietário, nem de desenvolvimento de plataformas SaaS ou soluções B2B digitais. O foco operacional permanece ancorado em processos comerciais tradicionais, com eventual apoio de sistemas de gestão internos, típicos de empresas varejistas.  BLOCO 4 — CONTEXTO DE MERCADO E POSICIONAMENTO  Inserida no setor de papelaria e suprimentos, a empresa atua em um mercado altamente competitivo e fragmentado, onde diferenciação ocorre principalmente por preço, conveniência, localização e variedade de produtos. Diferentemente de empresas SaaS B2B, que escalam por meio de tecnologia e automação, o crescimento da CAIS DO PAPEL está diretamente relacionado à expansão física, aumento de mix de produtos e fidelização de clientes regionais.  Seu posicionamento não está associado a soluções de automação de processos empresariais, analytics, onboarding digital ou gestão de pessoas, mas sim ao fornecimento de insumos necessários para o funcionamento de escritórios, escolas e residências. Ainda que atenda empresas, seu papel é de fornecedor de bens de consumo e não de parceiro estratégico em transformação digital ou otimização de processos organizacionais.  BLOCO 5 — COBERTURA GEOGRÁFICA E CONTEXTO OPERACIONAL  A atuação geográfica da empresa é predominantemente local, concentrada em São João da Boa Vista – SP, o que reforça seu caráter regional e sua proximidade com a base de clientes. Essa cobertura limitada favorece relações comerciais diretas, conhecimento aprofundado do mercado local e atendimento personalizado, mas também restringe a escalabilidade típica de modelos digitais ou SaaS, que operam em âmbito nacional ou internacional com baixo custo marginal.  A empresa não apresenta características de operação remota, multitenant ou orientada a plataformas digitais. Seu valor está na disponibilidade imediata de produtos físicos e na conveniência para clientes locais, em contraste com empresas de tecnologia que entregam valor por meio de software, automação e dados. Esse contexto operacional consolida a CAIS DO PAPEL como uma empresa de varejo tradicional, com forte ancoragem territorial e foco em produtos físicos.","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-912,-256],"id":"895e24bc-f741-4aaf-8512-39b84f408e0b","name":"teste-txt"},{"parameters":{"assignments":{"assignments":[{"id":"4ef77cf2-4abe-4ce2-96d7-8507dd01d5f1","name":"prompt","value":"={{ \n  { \n    model: \"mistralai/Ministral-3-3B-Instruct-2512\", \n    messages: [ \n      { \n        role: \"user\", \n        content: \"Tarefa:\\nVocê receberá um texto extenso e não estruturado contendo informações explícitas e implícitas sobre uma empresa. A partir exclusivamente desse texto, reconstrua o perfil completo da empresa.\\n\\nExtraia e organize as informações sempre que possível nos seguintes eixos:\\n- Nome ou identificação da empresa\\n- Indústria principal\\n- Modelo de negócio\\n- Produtos e/ou serviços oferecidos\\n- Público-alvo\\n- Cobertura geográfica\\n- Nível de uso de tecnologia\\n\\nRegras:\\n- Baseie-se apenas nas informações inferidas do texto fornecido\\n- Não faça suposições externas\\n- Se alguma informação não estiver clara, indique como \\\"não identificado\\\"\\n- Seja objetivo, técnico e estruturado\\n\\nFormato obrigatório da resposta (não altere):\\nNOME_DA_EMPRESA:\\nINDUSTRIA:\\nMODELO_DE_NEGOCIO:\\nPRODUTOS_SERVICOS:\\nPUBLICO_ALVO:\\nCOBERTURA_GEOGRAFICA:\\nUSO_DE_TECNOLOGIA: 500 tokens\"\n      }, \n      { \n        role: \"user\", \n        content: $json.text \n      } \n    ], \n    temperature: 0.1, \n    max_tokens: 500, \n    stream: false   \n  } \n}}","type":"object"},{"id":"3c41d7ae-85ff-44b8-a0f4-e3f5b78d82e0","name":"URL_VLLM","value":"https://5u888x525vvzvs-8000.proxy.runpod.net","type":"string"},{"id":"17e1d809-35d6-46f7-b825-291b9ccba133","name":"URL_METRICS","value":"https://5u888x525vvzvs-9100.proxy.runpod.net","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-384,-144],"id":"fafd0ba6-a794-4129-96c7-7bac3e127dae","name":"Prompt + URL_VLLM + URL_METRICS"}],"connections":{"When clicking ‘Execute workflow’":{"main":[[{"node":"Code in JavaScript1","type":"main","index":0}]]},"Select rows from a table":{"main":[[]]},"Edit Fields":{"main":[[{"node":"Edit Fields1","type":"main","index":0}]]},"Edit Fields1":{"main":[[{"node":"Code in JavaScript","type":"main","index":0}]]},"Code in JavaScript":{"main":[[{"node":"Edit Fields2","type":"main","index":0}]]},"Edit Fields2":{"main":[[]]},"Edit Fields3":{"main":[[{"node":"Summarize","type":"main","index":0}]]},"LLM":{"main":[[]]},"Loop Over Items":{"main":[[],[{"node":"Prompt + URL_VLLM + URL_METRICS","type":"main","index":0}]]},"Call 'Processa Scrape Fornecedores'":{"main":[[{"node":"Wait","type":"main","index":0}]]},"Wait":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"teste-txt":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Code in JavaScript1":{"main":[[{"node":"teste-txt","type":"main","index":0}]]},"Prompt + URL_VLLM + URL_METRICS":{"main":[[{"node":"Call 'Processa Scrape Fornecedores'","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"3da11091-9d60-419a-bdc5-8a4b7350d17c","activeVersionId":null,"triggerCount":0,"shared":[{"updatedAt":"2025-12-26T21:50:24.658Z","createdAt":"2025-12-26T21:50:24.658Z","role":"workflow:owner","workflowId":"066SnWM5lAL0DjBV","projectId":"jk0yZKautC5L7CBp"}],"activeVersion":null,"tags":[]}